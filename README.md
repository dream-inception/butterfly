## 概述

本项目的 PCB 参考于：笑君悉 的 [蝴蝶女神](https://oshwhub.com/jy2054289596/streamed-butterfly-shadow)
在原版本的基础上做了 “一点点” 修改，增加了 电池供电、 Wi-Fi 无线控制、语音识别、振动感应、 Touch 触控等功能。

设计理念旨在尽量模拟生物特征，其中大脑部分采用 ESP32-S3 处理信息，小脑部分利用 MPU 6050 感应振动。项目模拟生物形态，将天线作为“口器”，并设有“腹部”储能单元，整个开发板沿中心对称布局。

最终效果参见 B 站视频：
1. [电子蝴蝶-灯光模式](https://www.bilibili.com/video/BV1vx4y1a7Nb/)
2. [电子蝴蝶-控制模式](https://www.bilibili.com/video/BV1iz421C7rY/)

## 光明女神闪蝶（世界上最美的蝴蝶）简介

光明女神蝶数量稀少，因而十分珍贵，一只光明女神蝶的标本曾拍出过4.3万美元的高价，折合人名币约 36 万元。
光明女神蝶象征着美丽，在当地有一种象征意义，认为女神蝶给美丽的女人带来第二次生命，让她们在重生中获得最优秀男子的爱情，所以不少巴西女子收藏女神蝶，以此来祈祷收货美满的爱情
光明女神蝶也是 [唐家三少](https://baike.baidu.com/item/%E5%94%90%E5%AE%B6%E4%B8%89%E5%B0%91/1855351?fromModule=lemma_inlink) 所著小说《[斗罗大陆](https://baike.baidu.com/item/%E6%96%97%E7%BD%97%E5%A4%A7%E9%99%86/55276691?fromModule=lemma_inlink)》专门为[唐舞桐](https://baike.baidu.com/item/%E5%94%90%E8%88%9E%E6%A1%90/22612028?fromModule=lemma_inlink)（化名 王冬）打造的专属武魂。 光明女神蝶为斗罗大陆最美丽的蝴蝶武魂，乃是兽武魂中美丽的极致
一双蓝色的蝴蝶翅膀瞬间张开，前翅两端的颜色由深蓝、湛蓝、浅蓝不断的变化，整个翅面犹如蓝色的天空镶嵌一串亮丽的光环，呈V字形，给人间带来光明。它的形状、颜色都是无与伦比、无可挑剔的美丽。整个翅面犹如蔚蓝的大海上涌起朵朵白色的浪花，其颜色及花纹非常壮观，呈紫蓝色，整个翅面犹如蓝色的天空镶嵌一串亮丽的光环，时而深蓝，时而湛蓝，时而浅蓝，双翅上的白色满文就像镶嵌上去的珠宝，光彩熠熠，十分迷人。

## 使用说明

本项目支持多种模式，包括灯光模式、音乐律动模式、遥控器模式和传感器模式，用户可以通过语音指令切换不同模式，并通过“眼睛”指示灯显示当前模式

### 灯光模式

- 模式选择：“灯光模式”，“夜灯模式”
- 模式指示：眼睛指示灯为 白色
- 语音控制：包括开/关灯，调整灯光颜色（白、红、绿、蓝）和亮度，以及特殊的“闪烁”命令
![快照_23.PNG](https://image.lceda.cn/pullimage/OBC7aasnUu2bQzXPFHVrIrFCutRN2wX2zV4Rv3Dl.png)
    - 开灯：“打开电灯”、“开灯”
    - 关灯：“关闭电灯”、“关灯”
    - 白灯：“把灯调成白色”、“白灯”、“白色”
    - 蓝灯：“把灯调成蓝色”、“蓝灯”、“蓝色”
    - 绿灯：“把灯调成绿色”、“绿灯”、“绿色”、“爱的颜色”
    - 红灯：“把灯调成红色”、“红灯”、“红色”、“原谅她”
    - 闪烁：“第二魂技 蝶神之光”、“蝶神之光”
- 亮度调节：通过触摸触角来调节灯光的亮度
    - 左侧触角增加亮度
    - 右侧触角减少亮度
- 小台灯：根据MPU6050检测的角度自动开/关灯
![快照_26.PNG](https://image.lceda.cn/pullimage/8lVXGFRWTdflPNipiVYGqNIxWcHvdd1wVk05BaRi.png)
    - 水平开灯
    - 垂直关灯
- 敲击开灯：利用MPU6050检测敲击加速度来控制灯光
![快照_24.PNG](https://image.lceda.cn/pullimage/3swxtqeEh0pxHVk2OWcWAvvBsPjU2Mv1a1qeLrfC.png)
    - 轻轻敲击在开灯与关灯之间切换
    - 用力敲击，开灯 10 秒内未再次检测到敲击关灯
    
- 手机控制：通过App控制灯光的色相、饱和度、明度
![IMG_8702_0003.gif](https://image.lceda.cn/pullimage/djrjgupIPnMauKgJgNR0mQzVSmAfpBcxxlT88HkU.gif)
### 音乐律动模式
![IMG_8692_0001.gif](https://image.lceda.cn/pullimage/cMeVE6d4FfuHCyJoFlJp6HoUvQ5nna5tK6eRK2HC.gif)
- 模式选择：“音乐律动模式”，“音乐律动”
- 模式指示：眼睛指示灯为 蓝 色
- 功能简介：根据音乐的频率和响度改变灯光颜色和亮度
    - 使用 FFT 获取音乐中的频率来改变灯光的颜色
    - 获取 响度 来改变灯光的亮度

### 遥控器模式

- 模式选择：“遥控模式”，“远程控制模式”
- 模式指示：眼睛指示灯为 红 色
- 功能简介：接入 Home Assistant ，与家里的 米家、美的、涂鸦、Apple 等智能设备进行联动
    - 四个翅膀相当于四个开关，可以分别联动四种不同的智能设备
    - 通过语音命令控制空调、洗衣机、浴霸等

### 传感器模式（待实现）

- 模式选择：“遥控模式”，“远程控制模式”
- 模式指示：眼睛指示灯为 绿 色
- 功能简介：
    - **振动传感器**：通过 MPU6050 检测振动、跌落、倾斜与智能家居进行联动
    - **触摸传感器**：通过 ESP32-S3 Touch Sensor 的功能电容大小判断是否触摸
    - **温度传感器**：通过 ESP32-S3 芯片内置温度传感器来进行检测
    - **人体移动传感器**：通过 ESP32-S3 芯片 Wi-Fi CSI 功能来实现人体移动的检测

### 语音控制：

- 唤醒词：唤醒词可修改，支持 你好小智、小爱同学、Hi,乐鑫等多个唤醒词
- 免唤醒：检测到振动、跌落、倾斜 或 翅膀被捏住时会被唤醒
- 连续识别：被唤醒后可以连续识别，无需要再次唤醒
- 命令词：支持自定命令词 200 条，可以多条不同的命令词对一条控制指令

### 供电方式
- 雄蝶充电口使用 type-c 公口，可以直接使用手机对其进行充电
![公.jpg](https://image.lceda.cn/pullimage/ZC15IPPMDSg9bWAdHfRojlzd2rJNbuRleob6aEpf.jpeg)
- 雌蝶充电口使用 type-c 母口，并且支持磁吸充电方式，当她吸附在昊天锤上充电
![母.jpg](https://image.lceda.cn/pullimage/3qeR0mM6FeTvEO5Jj1Wy7gnMdiOg6l09c0xTuDsQ.jpeg)
- 为了给 光明女神闪蝶 完整的一生，蝴蝶支持低功耗模式，通过 MPU6050 唤醒

## 复刻注意事项
1. **本项焊接难度较大，不适合新手复刻**: 由于PCB尺寸限制，采用的元件大多为0402封装，还有特别是 ESP32-S3-PICO-1 焊接管脚在芯片背面，焊接成功率极低
2. **四层板的版本无法彩印**：受限于制造工艺，立创的工艺不支持四层板彩印
  